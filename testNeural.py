
from keras.models import Model
from keras.layers import *    
from tensorflow.keras.layers import Dense, Concatenate
from tensorflow.keras import Input, Model
import numpy as np
import keras
import tensorflow as tf

inpo=[-1.0, 0.0, -1.5, -0.33333333333333337, -0.25, -0.19999999999999996, 0.0, 0.6666666666666667, -0.4, 1.5, 0.0, 0.0, -0.5, -0.33333333333333337, -0.25, 0.0, 0.33333333333333326, 0.5, 1.0, -0.5, 0.33333333333333326, -0.4, 0.0, -0.16666666666666663, 0.0, -0.4, -0.09090909090909094, 0.375, -0.3999999999999999, -0.16666666666666663, 2.0, -0.25, 0.33333333333333326, 0.0, -0.75, -0.19047619047619058, 0.3999999999999999, -0.16666666666666663, 0.0, 0.5, 0.0, -0.33333333333333337, -0.25, 0.0, 0.75, -0.33333333333333337, 0.0, -0.25, 0.33333333333333326, -0.25, 0.33333333333333326, 0.5, -0.33333333333333337, 0.0, -0.1428571428571429, 0.0, -0.2222222222222222, -0.18181818181818177, 0.0, 0.22222222222222232, 0.02564102564102555, 0.18181818181818188, 0.17142857142857137, 0.3999999999999999, 0.0, -0.2857142857142857, -0.2222222222222222, 0.11904761904761918, 0.19999999999999996, -0.2222222222222222, 0.0, 0.35897435897435903, 0.0444444444444444, -0.16666666666666663, 0.0, 0.1428571428571429, 1.3333333333333335, 0.5, 0.5000000000000001, 0.0, -0.050000000000000044, -0.16666666666666663, 0.5142857142857142, 0.23333333333333328, 0.0, 0.0, 0.0, 0.0, -0.1428571428571429, 0.0, 0.0, 0.6666666666666667, -0.4, -0.2857142857142857, 0.0, 0.04166666666666674, 0.0, -0.25, 0.0, 0.0, 0.0, 0.48888888888888893, -0.3194444444444444, 0.6888888888888889, 0.5666666666666668, -0.4, -0.2857142857142857, -0.2222222222222222, 0.0, -0.09090909090909094, 0.20238095238095244, 0.3999999999999999, -0.2857142857142857, -0.07692307692307687, -0.36363636363636365, 0.0, -0.15384615384615385, 0.0, 0.373015873015873, 0.7333333333333334, 0.0, 0.0, -0.16666666666666663, 0.5, 0.0, 0.0, -0.19999999999999996, -0.2857142857142857, 1.3333333333333335, 0.0, 0.0, 0.0, -0.25, 0.0, -0.3571428571428572, -0.05555555555555547, 0.04807692307692313, -0.19999999999999996, 0.1785714285714286, 0.0, 0.07619047619047614, -0.125, -0.12857142857142856, 0.6000000000000001, -0.1428571428571429, -0.125, 0.33333333333333326, 0.0, 0.4375, 0.33333333333333326, -0.4, 0.0, 0.0, -0.05882352941176472, -0.2857142857142857, 0.6447368421052632, 0.05555555555555558, 1.0, 0.0, 0.0, -0.052631578947368474, 0.0, 0.0, -0.5444444444444444, -0.2857142857142857, -0.09722222222222221, 0.0, 0.7411764705882353, 0.0, -0.05555555555555558, 0.0, 0.25, -0.19999999999999996, -0.2857142857142857, 0.0, -0.052631578947368474, -0.24444444444444446, 0.25, 0.0, 0.0, -0.14117647058823524, 0.6666666666666667, 0.19999999999999996, 0.0, -0.05555555555555558, 0.25, 0.0, -0.33333333333333337, -0.25, 0.33333333333333326, 0.14736842105263148, 0.0, 0.6666666666666667, 0.0, -0.4, -0.2857142857142857, 0.0]

inpa=[[1, 1, 0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 0, 0, 0, 1, 1, 2], [1, 1, 1, 1, 0, 0, 0, 1, 1, 2], [1, 1, 1, 1, 0, 0, 0, 1, 1, 2], [1, 1, 1, 1, 0, 0, 0, 1, 1, 2], [1, 1, 1, 1, 1, 1, 1, 1, 1, 2], [1, 1, 1, 1, 1, 1, 1, 1, 1, 2], [1, 1, 1, 1, 1, 1, 1, 1, 1, 0], [1, 1, 1, 1, 0, 1, 1, 1, 1, 1], [0, 0, 0, 1, 1, 1, 0, 0, 0, 0], [0, 0, 0, 1, 1, 1, 1, 1, 1, 1], [0, 0, 1, 1, 1, 1, 1, 1, 1, 1], [0, 0, 1, 1, 1, 1, 1, 1, 1, 1], [0, 0, 1, 1, 1, 1, 1, 1, 1, 1], [0, 0, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 0], [1, 1, 1, 1, 1, 1, 1, 1, 1, 0], [1, 1, 1, 1, 1, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 1, 0, 0, 0], [1, 1, 1, 1, 1, 1, 1, 0, 0, 0], [1, 1, 1, 1, 1, 1, 1, 0, 1, 1], [1, 1, 1, 1, 1, 0, 1, 0, 0, 0], [1, 1, 1, 1, 1, 0, 1, 0, 0, 0], [1, 1, 1, 1, 1, 0, 1, 1, 1, 1], [1, 1, 1, 1, 1, 0, 1, 1, 1, 1], [1, 1, 1, 1, 1, 0, 1, 1, 1, 1], [1, 1, 1, 1, 1, 0, 1, 1, 1, 1], [1, 1, 1, 1, 1, 0, 1, 1, 1, 1], [1, 1, 1, 1, 1, 0, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1], [1, 1, 1, 1, 1, 3, 1, 1, 1, 1]]
inpb=[2, 3, 6, 6, 1, 0, 5, 3, 0, 4, 6, 5, 3, 5, 0, 2, 2, 0, 3, 4, 4, 2, 0, 5, 6, 2, 3, 6, 1, 5, 0, 6, 0, 3, 0, 1, 6, 2, 0, 5, 6, 5, 2, 1, 6, 5, 6, 0, 5, 1, 2, 3, 5, 4, 3, 3, 6, 1, 3, 3, 3, 0, 5, 0, 6, 0, 4, 4, 3, 0, 0, 5, 2, 2, 2, 0, 6, 5, 5, 6, 2, 4, 2, 2, 4, 6, 1, 4, 3, 5, 4, 5, 3, 3, 3, 0, 3, 1, 2, 5, 0, 6, 2, 0, 2, 2, 6, 2, 3, 4, 5, 3, 3, 6, 3, 3, 2, 2, 0, 0, 6, 6, 1, 0, 2, 6, 3, 1, 4, 4, 2, 1, 5, 0, 3, 3, 6, 4, 2, 6, 6, 5, 4, 6, 6, 2, 3, 0, 3, 2, 5, 2, 5, 5, 1, 4, 0, 6, 2, 4, 1, 6, 5, 2, 4, 3, 1, 4, 5, 5, 6, 1, 2, 5, 5, 5, 0, 6, 3, 4, 0, 3, 4, 6, 5, 2, 6, 5, 0, 0, 2, 1, 6, 0, 1, 6, 6]
inpc=[4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]

inc=[2.5]*len(inpa)

target=np.array(inc)

inpa= np.array(inpa)
inpb=np.array(inpb)
inpc=np.array(inpc)
inpo=np.array(inpo)


# define two sets of inputs
inputA = Input(shape=(10,))
inputB = Input(shape=(1,))
inputC = Input(shape=(1,))

a = Dense(64, activation="relu")(inputA)

b = Dense(64, activation="relu")(inputB)

c = Dense(64, activation="relu")(inputC)
# combine the output of the two branches

d = Concatenate(axis=-1)([b, c])

e = Dense(64, activation="relu")(d)

f = Concatenate()([a, e])

final = Dense(64, activation="relu")(f)

output1 = Dense(4, activation ='softmax')(final)
output2 = Dense(4, activation='softmax')(final)


model = Model(inputs=[inputA,inputB,inputC], outputs=[output1, output2])

#compile just defines the loss and optimizer and stuff
model.compile(loss=['mae', 'sparse_categorical_crossentropy'], optimizer='adam')

#actualyl traning the model
model.fit([inpa,inpb,inpc], [inpo, target], epochs=10, batch_size=len(inpa))

tt=[[1, 1, 0, 0, 0, 0, 0, 0, 0, 0]]
tt2=[[2]]
tt3=[[4]]
tt=np.array(tt)
tt2=np.array(tt2)
tt3=np.array(tt3)

result = model.predict(tt,tt2,tt3)

print(result)